name: Run Java Program

on:
  workflow_dispatch:
    inputs:
      numbers:
        description: "Enter two numbers (example: 8 20)"
        required: false

jobs:
  run-java:
    runs-on: ubuntu-latest

    steps:
    # 1️⃣ Download repository files
    - name: Checkout repository
      uses: actions/checkout@v4

    # 2️⃣ Install Java 17
    - name: Setup Java
      uses: actions/setup-java@v4
      with:
        distribution: temurin
        java-version: '17'

    # 3️⃣ Create input.txt from user input
    - name: Create input file
      run: |
        if [ -z "${{ github.event.inputs.numbers }}" ]; then
          echo "5 3" > input.txt
        else
          echo "${{ github.event.inputs.numbers }}" > input.txt
        fi

    # 4️⃣ Compile ALL Java files
    - name: Compile Java
      run: javac *.java

    # 5️⃣ Run program
    - name: Run Java Program
      run: java Main > output.txt

    # 6️⃣ Convert output to webpage
    - name: Create output webpage
      run: |
        echo "<html>" > index.html
        echo "<body style='background:black;color:lime;font-family:monospace'>" >> index.html
        echo "<h2>Java Program Output</h2><pre>" >> index.html
        cat output.txt >> index.html
        echo "</pre></body></html>" >> index.html

    # 7️⃣ Prepare site files
    - name: Prepare site files
      run: |
        mkdir public
        cp index.html public/
        cp form.html public/

    # 8️⃣ Deploy to GitHub Pages
    - name: Deploy Website
      uses: peaceiris/actions-gh-pages@v4
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: ./public
